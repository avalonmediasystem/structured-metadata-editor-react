(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{165:function(e,t,n){e.exports=n.p+"static/media/utah_phillips_one.786f6474.mp3"},175:function(e,t,n){e.exports=n(460)},184:function(e,t,n){},460:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"handleResponse",function(){return K}),n.d(a,"closeAlert",function(){return Q});var i=n(0),r=n.n(i),l=n(21),s=n.n(l),o=n(4),c=n(5),u=n(12),m=n(9),d=n(11),p=(n(184),n(34)),h=n.n(p),f=n(66),v=n(97),b=n.n(v),g="https://spruce.dlib.indiana.edu",O=new Headers;O.append("Content-Type","application/json");var y=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,[{key:"getRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O,n="".concat(g,"/master_files/").concat("j3860704z","/").concat(e);return b.a.get(n,{headers:t})}},{key:"postRequest",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O,a="".concat(g,"/master_files/").concat("j3860704z","/").concat(e);return b.a.post(a,t,{headers:n})}}]),e}(),E=n(10),C="ADD_HEADING",k="BUILD_SM_UI",T="DELETE_ITEM",j="ADD_DROP_TARGETS",S="REMOVE_DROP_TARGETS",D="SET_ACTIVE_DRAG_SOURCE",w="REMOVE_ACTIVE_DRAG_SOURCES",I="HANDLE_LIST_ITEM_DROP",x="INIT_PEAKS";var R=n(23),H=n(461),A=n(462),F=n(463),N=n(471),P=n(464),M=n(470),V=n(467),_=n(165),U=n.n(_),L=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).zoomIn=function(){n.props.peaksInstance.zoom.zoomIn()},n.zoomOut=function(){n.props.peaksInstance.zoom.zoomOut()},n.seekTime=function(){var e=parseFloat(n.state.seekTime);Number.isNaN(e)||n.props.peaksInstance.player.seek(e)},n.state={seekTime:""},n.waveformContainer=r.a.createRef(),n.mediaPlayer=r.a.createRef(),n.handleSubmit=n.handleSubmit.bind(Object(R.a)(Object(R.a)(n))),n.handleChange=n.handleChange.bind(Object(R.a)(Object(R.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.waveformRef(this.waveformContainer.current),this.props.mediaPlayerRef(this.mediaPlayer.current)}},{key:"handleSubmit",value:function(e){this.seekTime(),e.preventDefault()}},{key:"handleChange",value:function(e){this.setState({seekTime:e.target.value})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{id:"waveform-container",ref:this.waveformContainer}),r.a.createElement(H.a,null,r.a.createElement(A.a,{xs:12,md:6},r.a.createElement("audio",{controls:!0,ref:this.mediaPlayer,src:U.a,type:"audio/mp3"},"Your browser does not support the audio element.")),r.a.createElement(A.a,{xs:12,md:6,className:"text-right"},r.a.createElement(F.a,{inline:!0,onSubmit:this.handleSubmit},r.a.createElement(N.a,null,r.a.createElement(P.a,null,r.a.createElement(M.a,{className:"glyphicon glyphicon-zoom-in",onClick:this.zoomIn}),r.a.createElement(M.a,{className:"glyphicon glyphicon-zoom-out",onClick:this.zoomOut})))," ",r.a.createElement(V.a,{className:"form-control",type:"text",value:this.state.seekTime,onChange:this.handleChange,placeholder:"0"})," ",r.a.createElement(M.a,{onClick:this.seekTime},"Seek")))))}}]),t}(i.Component),q=Object(E.b)(function(e){return{peaksInstance:e.peaksInstance}})(L),z=new y,B={container:null,mediaElement:null,dataUri:null,dataUriDefaultFormat:"json",keyboard:!0,pointMarkerColor:"#006eb0",showPlayheadTime:!0,zoomWaveformColor:"rgba(217, 217, 217, 1)"},W=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).waveformContainer=null,n.mediaPlayer=null,n.peaksInstance=null,n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(h.a.mark(function e(){var t=this;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B.container=this.waveformContainer,B.mediaElement=this.mediaPlayer,e.next=4,z.getRequest("waveform.json").then(function(e){B.dataUri=e.request.responseURL,t.props.initPeaks(t.props.smData,B)}).catch(function(e){void 0!==e.response?t.props.handleResponse(e.response.status):void 0!==e.request?t.props.handleResponse(e.request.status):t.props.handleResponse(-1)});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"waveform-section"},r.a.createElement(q,{waveformRef:function(t){return e.waveformContainer=t},mediaPlayerRef:function(t){return e.mediaPlayer=t}}))}}]),t}(i.Component),Z=Object(E.b)(function(e){return{smData:e.smData}},function(e){return{initPeaks:function(t,n){return e(function(e,t){return{type:x,smData:e,options:t}}(t,n))}}})(W),G=n(472),J=n(469),K=function(e){return{type:"API_RESPONSE",code:e}},Q=function(){return{type:"CLOSE_ALERT"}},Y=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleDismiss=n.handleDismiss.bind(Object(R.a)(Object(R.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleDismiss",value:function(){this.props.closeAlert()}},{key:"createAlert",value:function(){var e=this.props.showForms.statusCode;switch(!0){case 401===e:return r.a.createElement("div",null,r.a.createElement(J.a,{bsStyle:"danger",onDismiss:this.handleDismiss},r.a.createElement("p",null,"Unauthorized to access the masterfile.")));case 404===e:return r.a.createElement("div",null,r.a.createElement(J.a,{bsStyle:"danger",onDismiss:this.handleDismiss},r.a.createElement("p",null,"Requested masterfile not found.")));case e>=200&&e<300:return r.a.createElement("div",null,r.a.createElement(J.a,{bsStyle:"success",onDismiss:this.handleDismiss},r.a.createElement("p",null,"Successfully saved to masterfile.")));default:return r.a.createElement("div",null,r.a.createElement(J.a,{bsStyle:"danger",onDismiss:this.handleDismiss},r.a.createElement("p",null,"Network error, please try again!")))}}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("br",null),this.createAlert())}}]),t}(r.a.Component),$=Object(E.b)(function(e){return{showForms:e.showForms}},function(e){return{closeAlert:function(){return e(Q())}}})(Y),X=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.props.showForms.alert&&r.a.createElement($,null))}}]),t}(i.Component),ee=Object(E.b)(function(e){return{showForms:e.showForms}})(X),te=n(69),ne=n(68),ae=n(17),ie=n(19),re=n(169),le=n.n(re),se=n(35),oe=n.n(se),ce=function(){function e(){var t=this;Object(o.a)(this,e),this.dndHelper={addSpanBefore:function(e,n){var a=t.getParentDiv(n,e),i=a.items.map(function(e){return e.id}).indexOf(n.id);a.items[i+1]&&"optional"!==a.items[i+1].type&&a.items.splice(i+1,0,t.createDropZoneObject())},addSpanAfter:function(e,n){var a=t.getParentDiv(n,e),i=a.items.map(function(e){return e.id}).indexOf(n.id);a.items.splice(i,0,t.createDropZoneObject())},stuckInMiddle:function(e,t,n){return 0!==e&&e!==t.length-1&&"span"===n.items[e-1].type&&"span"===n.items[e+1].type},addSpanToEmptyHeader:function(e,n){var a=t.findWrapperHeaders(e,n);a.after&&a.after.items.splice(0,0,t.createDropZoneObject())}}}return Object(c.a)(e,[{key:"createDropZoneObject",value:function(){return{type:"optional",id:oe()()}}},{key:"createSpanObject",value:function(e){return{id:oe()(),type:"span",label:e.timespanTitle,begin:e.beginTime,end:e.endTime}}},{key:"deleteListItem",value:function(e,t){var n=Object(ae.a)(t),a=this.findItem(e,t),i=this.getParentDiv(a,n),r=Object(ie.findIndex)(i.items,{id:a.id});return i.items.splice(r,1),n}},{key:"determineDropTargets",value:function(e,t){var n=Object(ae.a)(t);if("span"===e.type){var a=this.findWrapperSpans(e,this.getItemsOfType("span",t)),i=this.getParentDiv(e,t),r=i?i.items:[],l=r.map(function(e){return e.id}).indexOf(e.id);if(this.dndHelper.stuckInMiddle(l,r,i))return n;if(0!==l&&"div"===r[l-1].type){var s=r[l-1];s.items?s.items.push(this.createDropZoneObject()):s.items=[this.createDropZoneObject()]}if(l!==r.length-1&&"div"===r[l+1].type){var o=r[l+1];o.items?o.items.unshift(this.createDropZoneObject()):o.items=[this.createDropZoneObject()]}var c=this.getParentDiv(i,t),u=c?c.items.map(function(e){return e.id}).indexOf(i.id):null;if(0===l){if(null===u)return n;c&&(c.items.splice(u,0,this.createDropZoneObject()),a.before&&this.dndHelper.addSpanBefore(t,a.before))}a.after&&this.dndHelper.addSpanAfter(t,a.after),a.after||this.dndHelper.addSpanToEmptyHeader(i,t)}return n}},{key:"doesTimeOverlap",value:function(e,t){var n=this.toMs,a=!0;for(var i in e=n(e),t){var r=n(t[i].begin),l=n(t[i].end);if(e>=r&&e<l){a=!1;break}}return a}},{key:"doesTimespanOverlap",value:function(e,t,n){var a=this.toMs,i=n.filter(function(t){return a(e)<a(t.begin)});return 0!==i.length&&a(t)>a(i[0].begin)}},{key:"findItem",value:function(e,t){var n=null;return function t(a){var i=!0,r=!1,l=void 0;try{for(var s,o=a[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var c=s.value;c.id===e&&(n=c),c.items&&c.items.length>0&&t(c.items)}}catch(u){r=!0,l=u}finally{try{i||null==o.return||o.return()}finally{if(r)throw l}}}(t),n}},{key:"findItemByLabel",value:function(e,t){var n=null;return function t(a){var i=!0,r=!1,l=void 0;try{for(var s,o=a[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var c=s.value;c.label===e&&(n=c),c.items&&t(c.items)}}catch(u){r=!0,l=u}finally{try{i||null==o.return||o.return()}finally{if(r)throw l}}}(t),n}},{key:"findWrapperSpans",value:function(e,t){var n=this.toMs,a={before:null,after:null},i=t.filter(function(t){return n(e.begin)>=n(t.end)}),r=t.filter(function(t){return n(e.end)<=n(t.begin)});return a.before=i.length>0?i[i.length-1]:null,a.after=r.length>0?r[0]:null,a}},{key:"findWrapperHeaders",value:function(e,t){var n={before:null,after:null},a=this.getParentDiv(e,t),i=a?a.items.map(function(e){return e.label}).indexOf(e.label):null;return n.before=void 0!==a.items[i-1]?a.items[i-1]:null,n.after=void 0!==a.items[i+1]?a.items[i+1]:null,n}},{key:"getItemsOfType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return function t(a){var i=!0,r=!1,l=void 0;try{for(var s,o=a[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var c=s.value;if(c.type===e){var u=Object(ne.a)({},c);delete u.items,n.push(u)}c.items&&t(c.items)}}catch(m){r=!0,l=m}finally{try{i||null==o.return||o.return()}finally{if(r)throw l}}}(t),n}},{key:"getParentDiv",value:function(e,t){var n=null;return function e(t,a){var i=!0,r=!1,l=void 0;try{for(var s,o=a[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var c=s.value;if(c.items){if(c.items.filter(function(e){return t.id===e.id}).length>0){n=c;break}e(t,c.items)}}}catch(u){r=!0,l=u}finally{try{i||null==o.return||o.return()}finally{if(r)throw l}}}(e,t),n}},{key:"getValidHeadings",value:function(e,t){var n=[],a=[],i=function e(t,a){var i=!0,r=!1,l=void 0;try{for(var s,o=a[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var c=s.value;if(c.items){if(c.items.filter(function(e){return e.id===t.id}).length>0){c.items;var u=Object(te.a)(c,["items"]);n.push(u)}e(t,c.items)}}}catch(m){r=!0,l=m}finally{try{i||null==o.return||o.return()}finally{if(r)throw l}}},r=this.getItemsOfType("div",t);if(e.before||e.after||(n=r),e.before&&i(e.before,t),e.after&&i(e.after,t),!e.before&&e.after||e.before&&!e.after){var l=this.getValidHeadingForEmptySpans(e,t);n=n.concat(l)}return r.forEach(function(e){var t=!1;n=n.filter(function(n){return!(!t&&n.label===e.label)||(a.push(n),t=!0,!1)})}),a}},{key:"getValidHeadingForEmptySpans",value:function(e,t){var n=this,a=null,i=function(e,a){var i=n.findWrapperHeaders(e,t);switch(a){case"before":return i.before?i.before:e;case"after":return i.after?i.after:e;default:return e}},r=[],l=function e(t,n){if(t!==n){var a=t.items;if(a){var i=!0,l=!1,s=void 0;try{for(var o,c=a[Symbol.iterator]();!(i=(o=c.next()).done);i=!0){var u=o.value;if("div"===u.type){u.items;var m=Object(te.a)(u,["items"]);r.push(m)}e(u,n)}}catch(d){l=!0,s=d}finally{try{i||null==c.return||c.return()}finally{if(l)throw s}}}}};if(!e.after&&e.before){var s=this.getParentDiv(e.before,t);l(a=i(s,"after"),s)}if(!e.before&&e.after){var o=this.getParentDiv(e.after,t);l(a=i(o,"before"),o)}var c=a,u=(c.items,Object(te.a)(c,["items"]));return r.push(u),r}},{key:"handleListItemDrop",value:function(e,t,n){var a=Object(ae.a)(n),i=this.findItem(e.id,a),r=this.getParentDiv(i,a),l=r.items.map(function(e){return e.id}).indexOf(i.id);r.items.splice(l,1);var s=this.getParentDiv(t,a),o=s.items.map(function(e){return e.id}).indexOf(t.id);return s.items.splice(o,0,i),this.removeDropTargets(a)}},{key:"insertNewHeader",value:function(e,t){var n=Object(ae.a)(t),a=this.findItem(e.headingChildOf,n)||n[0];return a&&a.items.unshift({id:oe()(),type:"div",label:e.headingTitle,items:[]}),n}},{key:"insertNewTimespan",value:function(e,t){var n=Object(ae.a)(t),a=this.findItem(e.timespanChildOf,n),i=this.createSpanObject(e),r=0;if(a){var l=a.items.filter(function(e){return"span"===e.type}),s=this.findWrapperSpans(i,l);s.before&&(r=Object(ie.findIndex)(a.items,{id:s.before.id})+1),a.items.splice(r,0,i)}return n}},{key:"removeActiveDragSources",value:function(e){return[function e(t){return t.items?(t.items=t.items.map(function(t){return e(t)}),t):(t.active&&(t.active=!1),t)}(e[0])]}},{key:"removeDropTargets",value:function(e){return[function e(t,n){return t.items?(t.items=t.items.filter(function(e){return e.type!==n}).map(function(t){return e(t,n)}),t):t}(e[0],"optional")]}},{key:"toMs",value:function(e){return le.a.duration(e).asMilliseconds()}},{key:"updateHeading",value:function(e,t){var n=Object(ae.a)(t);return this.findItem(e.id,n).label=e.headingTitle,n}},{key:"validateBeforeEndTimeOrder",value:function(e,t){return!e||!t||!(this.toMs(e)>=this.toMs(t))}},{key:"validTimeFormat",value:function(e){return e&&3===e.split(":").length}}]),e}(),ue=n(465),me=new ce;function de(e,t){var n=me.findItem(e,t);if("div"===n.type)return{headingTitle:n.label};if("span"===n.type){var a=me.getParentDiv(n,t);return{beginTime:n.begin,endTime:n.end,timespanChildOf:a?a.id:"",timespanTitle:n.label}}}function pe(e,t){if(!e||-1===e.indexOf(":"))return null;var n=me.validTimeFormat(e),a=me.doesTimeOverlap(e,t);return n&&a?"success":n&&a?null:"error"}function he(e,t,n){if(!t||-1===t.indexOf(":"))return null;var a=me.validTimeFormat(t),i=me.doesTimeOverlap(t,n),r=me.validateBeforeEndTimeOrder(e,t),l=me.doesTimespanOverlap(e,t,n);return a&&i&&r&&!l?"success":a&&i&&r&&!l?null:"error"}function fe(e){return e.length>2?"success":e.length>0?"error":null}function ve(e){return e.length>2}function be(e,t,n,a){return me.validTimeFormat(e)?me.validTimeFormat(t)?me.doesTimeOverlap(e,n)?me.doesTimeOverlap(t,n)?me.validateBeforeEndTimeOrder(e,t)?me.doesTimespanOverlap(e,t,n)?{valid:!1,message:"New timespan region overlaps an existing timespan region"}:{valid:!0}:{valid:!1,message:"Begin time must start before end time"}:{valid:!1,message:"End time overlaps an existing timespan region"}:{valid:!1,message:"Begin time overlaps an existing timespan region"}:{valid:!1,message:"Invalid end time format"}:{valid:!1,message:"Invalid begin time format"}}var ge=new ce,Oe=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={headingTitle:"",headingChildOf:"",childOfOptions:[]},n.handleCancelClick=function(){n.props.toggleHeading()},n.handleChildOfChange=function(e){n.setState({headingChildOf:e.target.value})},n.handleHeadingChange=function(e){n.setState({headingTitle:e.target.value})},n.handleSubmit=function(e){var t=n.state,a={headingChildOf:t.headingChildOf,headingTitle:t.headingTitle};e.preventDefault(),n.props.onSubmit(a),n.clearFormValues()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.smData.length>0&&this.processOptions()}},{key:"componentDidUpdate",value:function(e){Object(ie.isEqual)(this.props.smData,e.smData)||this.processOptions()}},{key:"clearFormValues",value:function(){this.setState({headingTitle:"",headingChildOf:"",childOfOptions:[]})}},{key:"formIsValid",value:function(){var e=this.state.headingTitle;return e&&e.length>0}},{key:"getOptions",value:function(){return ge.getItemsOfType("div",this.props.smData).map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.label)})}},{key:"processOptions",value:function(){var e=this.getOptions();this.setState({childOfOptions:e})}},{key:"render",value:function(){var e=this.state.headingTitle;return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(N.a,{controlId:"headingTitle",validationState:fe(e)},r.a.createElement(ue.a,null,"Title"),r.a.createElement(V.a,{type:"text",value:e,onChange:this.handleHeadingChange}),r.a.createElement(V.a.Feedback,null)),r.a.createElement(N.a,{controlId:"headingChildOf"},r.a.createElement(ue.a,null,"Child Of"),r.a.createElement(V.a,{componentClass:"select",placeholder:"select",onChange:this.handleChildOfChange,value:this.state.headingChildOf},r.a.createElement("option",{value:""},"Select..."),this.state.childOfOptions)),r.a.createElement(H.a,null,r.a.createElement(A.a,{xs:12},r.a.createElement(P.a,{className:"pull-right"},r.a.createElement(M.a,{onClick:this.props.cancelClick},"Cancel"),r.a.createElement(M.a,{bsStyle:"primary",type:"submit",disabled:!this.formIsValid()},"Save")))))}}]),t}(i.Component),ye=Object(E.b)(function(e){return{smData:e.smData}},a)(Oe);function Ee(e){return{type:k,payload:e}}function Ce(e){return{type:T,id:e}}var ke=new ce,Te=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={message:null},n.submit=function(e){var t,a=n.props.smData,i={headingChildOf:e.headingChildOf,headingTitle:e.headingTitle};t=ke.insertNewHeader(i,a),n.props.buildSMUI(t),n.props.cancelClick()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(ye,{onSubmit:this.submit,cancelClick:this.props.cancelClick})}}]),t}(i.Component),je=Object(E.b)(function(e){return{smData:e.smData}},function(e){return{buildSMUI:function(t){return e(Ee(t))}}})(Te),Se=n(27),De=new ce,we=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).buildHeadingsOptions=function(){var e=n.props.smData,t={begin:n.state.beginTime,end:n.state.endTime},a=De.findWrapperSpans(t,n.allSpans),i=De.getValidHeadings(a,e);n.setState({validHeadings:i})},n.clearHeadingOptions=function(){n.setState({validHeadings:[]})},n.handleInputChange=function(e){n.setState(Object(Se.a)({},e.target.id,e.target.value))},n.handleSubmit=function(e){e.preventDefault();var t=n.state,a=t.beginTime,i=t.endTime,r=t.timespanChildOf,l=t.timespanTitle;n.props.onSubmit({beginTime:a,endTime:i,timespanChildOf:r,timespanTitle:l}),n.clearFormValues()},n.handleTimeChange=function(e){n.setState(Object(Se.a)({},e.target.id,e.target.value),n.updateChildOfOptions)},n.handleCancelClick=function(){void 0!==n.unEditedFormItem&&n.props.onSubmit(n.unEditedFormItem),n.props.cancelClick()},n.handleChildOfChange=function(e){n.setState({timespanChildOf:e.target.value})},n.state={beginTime:"",endTime:"",timespanChildOf:"",timespanTitle:"",validHeadings:[]},n.allSpans=null,n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.smData;Object(ie.isEqual)(t,e.smData)||(this.allSpans=De.getItemsOfType("span",t))}},{key:"clearFormValues",value:function(){this.setState({beginTime:"",endTime:"",timespanChildOf:"",timespanTitle:"",validHeadings:[]})}},{key:"formIsValid",value:function(){var e=ve(this.state.timespanTitle),t=this.state.timespanChildOf.length>0,n=this.localValidTimespans();return e&&t&&n.valid}},{key:"updateChildOfOptions",value:function(){this.localValidTimespans().valid?this.buildHeadingsOptions():this.clearHeadingOptions()}},{key:"localValidTimespans",value:function(){var e=this.state;return be(e.beginTime,e.endTime,this.allSpans,this.props.smData)}},{key:"render",value:function(){var e=this.state,t=e.beginTime,n=e.endTime,a=e.timespanChildOf,i=e.timespanTitle;return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(N.a,{controlId:"timespanTitle",validationState:fe(i)},r.a.createElement(ue.a,null,"Title"),r.a.createElement(V.a,{type:"text",value:i,onChange:this.handleInputChange}),r.a.createElement(V.a.Feedback,null)),r.a.createElement(H.a,null,r.a.createElement(A.a,{sm:6},r.a.createElement(N.a,{controlId:"beginTime",validationState:pe(t,this.allSpans)},r.a.createElement(ue.a,null,"Begin Time"),r.a.createElement(V.a,{type:"text",value:t,placeholder:"00:00:00",onChange:this.handleTimeChange}),r.a.createElement(V.a.Feedback,null))),r.a.createElement(A.a,{sm:6},r.a.createElement(N.a,{controlId:"endTime",validationState:he(t,n,this.allSpans)},r.a.createElement(ue.a,null,"End Time"),r.a.createElement(V.a,{type:"text",value:n,placeholder:"00:00:00",onChange:this.handleTimeChange}),r.a.createElement(V.a.Feedback,null)))),r.a.createElement(N.a,{controlId:"timespanChildOf"},r.a.createElement(ue.a,null,"Child Of"),r.a.createElement(V.a,{componentClass:"select",placeholder:"select",onChange:this.handleChildOfChange,value:a},r.a.createElement("option",{value:""},"Select..."),this.state.validHeadings.map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.label)}))),r.a.createElement(H.a,null,r.a.createElement(A.a,{xs:12},r.a.createElement(P.a,{className:"pull-right"},r.a.createElement(M.a,{onClick:this.props.cancelClick},"Cancel"),r.a.createElement(M.a,{bsStyle:"primary",type:"submit",disabled:!this.formIsValid()},"Save")))))}}]),t}(i.Component),Ie=we=Object(E.b)(function(e){return{smData:e.smData}},function(e){return{deleteItem:function(t){return e(Ce(t))}}})(we),xe=new ce,Re=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={message:null},n.submit=function(e){var t=xe.insertNewTimespan(e,n.props.smData);n.props.buildSMUI(t),n.props.cancelClick()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(Ie,{onSubmit:this.submit,cancelClick:this.props.cancelClick})}}]),t}(i.Component),He=Object(E.b)(function(e){return{smData:e.smData}},function(e){return{buildSMUI:function(t){return e(Ee(t))}}})(Re),Ae={section:{margin:"4rem 0"},well:{marginTop:"1rem"}},Fe=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={headingOpen:!1,timespanOpen:!1},n.handleCancelHeadingClick=function(){n.setState({headingOpen:!1})},n.handleCancelTimespanClick=function(){n.setState({timespanOpen:!1})},n.handleHeadingClick=function(){n.setState({headingOpen:!0,timespanOpen:!1})},n.handleTimeSpanClick=function(){n.setState({headingOpen:!1,timespanOpen:!0})},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("section",{style:Ae.section},r.a.createElement(H.a,null,r.a.createElement(A.a,{xs:6},r.a.createElement(M.a,{block:!0,onClick:this.handleHeadingClick},"Add a Heading")),r.a.createElement(A.a,{xs:6},r.a.createElement(M.a,{block:!0,onClick:this.handleTimeSpanClick},"Add a Timespan"))),r.a.createElement(G.a,{in:this.state.headingOpen},r.a.createElement("div",{className:"well",style:Ae.well},r.a.createElement(je,{cancelClick:this.handleCancelHeadingClick}))),r.a.createElement(G.a,{in:this.state.timespanOpen},r.a.createElement("div",{className:"well",style:Ae.well},r.a.createElement(He,{cancelClick:this.handleCancelTimespanClick}))),r.a.createElement(ee,null))}}]),t}(i.Component),Ne=Object(E.b)(function(e){return{smData:e.smData}})(Fe),Pe="span",Me=n(30),Ve=n(466),_e=n(468),Ue=n(31),Le=function(e){return r.a.createElement(Ve.a,{id:"tooltip"},e)},qe=function(e){return r.a.createElement("div",{className:"edit-controls-wrapper"},r.a.createElement(_e.a,{placement:"left",overlay:Le("Save")},r.a.createElement(M.a,{bsStyle:"link",disabled:!e.formIsValid,onClick:e.handleSaveClick},r.a.createElement(Ue.a,{icon:"save"}))),r.a.createElement(_e.a,{placement:"right",overlay:Le("Cancel"),onClick:e.handleCancelClick},r.a.createElement(M.a,{bsStyle:"link"},r.a.createElement(Ue.a,{icon:"minus-circle"}))))},ze=new ce,Be={formControl:{margin:"0 5px"}},We=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={beginTime:"",endTime:"",timespanTitle:""},n.handleCancelClick=function(){n.props.cancelFn()},n.handleInputChange=function(e){n.setState(Object(Se.a)({},e.target.id,e.target.value))},n.handleSaveClick=function(){var e=n.state,t=e.beginTime,a=e.endTime,i=e.timespanTitle;n.props.saveFn(n.props.item.id,{beginTime:t,endTime:a,timespanTitle:i})},n.tempSmData=void 0,n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.smData;this.tempSmData=Object(ie.cloneDeep)(e),this.setState(de(this.props.item.id,this.tempSmData)),this.tempSmData=ze.deleteListItem(this.props.item.id,this.tempSmData),this.allSpans=ze.getItemsOfType("span",this.tempSmData)}},{key:"formIsValid",value:function(){var e=this.state,t=e.beginTime,n=e.endTime,a=ve(this.state.timespanTitle),i=be(t,n,this.allSpans,this.tempSmData);return a&&i.valid}},{key:"render",value:function(){var e=this.state,t=e.beginTime,n=e.endTime,a=e.timespanTitle;return r.a.createElement(F.a,{inline:!0},r.a.createElement("div",{className:"row-wrapper"},r.a.createElement("div",null,r.a.createElement(N.a,{controlId:"timespanTitle",validationState:fe(a)},r.a.createElement(ue.a,null,"Title"),r.a.createElement(V.a,{type:"text",style:Be.formControl,value:a,onChange:this.handleInputChange})),r.a.createElement(N.a,{controlId:"beginTime",validationState:pe(t,this.allSpans)},r.a.createElement(ue.a,null,"Begin Time"),r.a.createElement(V.a,{type:"text",style:Be.formControl,value:t,onChange:this.handleInputChange})),r.a.createElement(N.a,{controlId:"endTime",validationState:he(t,n,this.allSpans)},r.a.createElement(ue.a,null,"End Time"),r.a.createElement(V.a,{type:"text",style:Be.formControl,value:n,onChange:this.handleInputChange}))),r.a.createElement(qe,{formIsValid:this.formIsValid(),handleSaveClick:this.handleSaveClick,handleCancelClick:this.handleCancelClick})))}}]),t}(i.Component),Ze=Object(E.b)(function(e){return{smData:e.smData}})(We),Ge={formControl:{margin:"0 5px",width:"300px"}},Je=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={headingTitle:""},n.handleCancelClick=function(){n.props.cancelFn()},n.handleInputChange=function(e){n.setState(Object(Se.a)({},e.target.id,e.target.value))},n.handleSaveClick=function(){var e=n.state.headingTitle;n.props.saveFn(n.props.item.id,{headingTitle:e})},n.tempSmData=void 0,n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.smData;this.tempSmData=Object(ie.cloneDeep)(e),this.setState(de(this.props.item.id,this.tempSmData))}},{key:"formIsValid",value:function(){return ve(this.state.headingTitle)}},{key:"render",value:function(){var e=this.state.headingTitle;return r.a.createElement(F.a,{inline:!0},r.a.createElement("div",{className:"row-wrapper"},r.a.createElement("div",null,r.a.createElement(N.a,{controlId:"headingTitle",validationState:fe(e)},r.a.createElement(ue.a,null,"Title"),r.a.createElement(V.a,{type:"text",style:Ge.formControl,value:e,onChange:this.handleInputChange}))),r.a.createElement(qe,{formIsValid:this.formIsValid(),handleSaveClick:this.handleSaveClick,handleCancelClick:this.handleCancelClick})))}}]),t}(i.Component),Ke=Object(E.b)(function(e){return{smData:e.smData}})(Je),Qe=new ce,Ye=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleCancelClick=function(e){n.props.handleEditFormCancel()},n.handleSaveClick=function(e,t){var a=Object(ie.cloneDeep)(n.props.smData),i=Qe.findItem(e,a);i=n.addUpdatedValues(i,t),n.props.buildSMUI(a),n.props.handleEditFormCancel()},n.type=n.props.item.type,n.id=n.props.item.id,n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"addUpdatedValues",value:function(e,t){return"div"===e.type?e.label=t.headingTitle:"span"===e.type&&(e.label=t.timespanTitle,e.begin=t.beginTime,e.end=t.endTime),e}},{key:"render",value:function(){var e=this.props.item;return"span"===e.type?r.a.createElement(Ze,{item:e,cancelFn:this.handleCancelClick,saveFn:this.handleSaveClick}):"div"===e.type?r.a.createElement(Ke,{item:e,cancelFn:this.handleCancelClick,saveFn:this.handleSaveClick}):void 0}}]),t}(i.Component),$e=Object(E.b)(function(e){return{smData:e.smData}},function(e){return{buildSMUI:function(t){return e(Ee(t))}}})(Ye),Xe=function(e){return r.a.createElement(Ve.a,{id:"tooltip"},e)},et=function(e){return r.a.createElement("div",{className:"edit-controls-wrapper"},"span"===e.itemType&&r.a.createElement(_e.a,{placement:"left",overlay:Xe("Show drop targets")},r.a.createElement(M.a,{bsStyle:"link"},r.a.createElement(Ue.a,{icon:"dot-circle",onClick:e.handleShowDropTargetsClick}))),r.a.createElement(_e.a,{placement:"top",overlay:Xe("Edit")},r.a.createElement(M.a,{bsStyle:"link"},r.a.createElement(Ue.a,{icon:"pen",onClick:e.handleEditClick}))),r.a.createElement(_e.a,{placement:"right",overlay:Xe("Delete")},r.a.createElement(M.a,{bsStyle:"link"},r.a.createElement(Ue.a,{icon:"trash",onClick:e.handleDelete}))))};var tt=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={editing:!1},n.handleDelete=function(){n.props.deleteItem(n.props.item.id)},n.handleEditClick=function(){var e=n.props.item;e.id,e.type;n.setState({editing:!0})},n.handleEditFormCancel=function(){n.setState({editing:!1})},n.handleShowDropTargetsClick=function(){var e=n.props,t=e.addDropTargets,a=e.item,i=e.removeActiveDragSources,r=e.removeDropTargets,l=e.setActiveDragSource;r(),!0!==a.active?(i(),t(a),l(a.id)):i()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.item.begin,a=e.item.end,i=e.item.items,l=e.item.label,s=e.item.type,o=e.item.active,c=e.connectDragSource,u=e.connectDropTarget,m=i&&i.length>0?r.a.createElement(ct,{items:i}):null;return c(u(r.a.createElement("li",{className:o?"active":""},this.state.editing&&r.a.createElement($e,{item:t,handleEditFormCancel:this.handleEditFormCancel}),!this.state.editing&&r.a.createElement("div",{className:"row-wrapper"},"span"===s&&r.a.createElement("span",{className:"structure-title"},l," (",n," - ",a,")"),"div"===s&&r.a.createElement("div",{className:"structure-title heading"},l),r.a.createElement(et,{handleDelete:this.handleDelete,handleEditClick:this.handleEditClick,itemType:s,handleShowDropTargetsClick:this.handleShowDropTargetsClick})),m)))}}]),t}(i.Component),nt={deleteItem:Ce,addDropTargets:function(e){return{type:j,payload:e}},removeDropTargets:function(){return{type:S}},removeActiveDragSources:function(){return{type:w}},setActiveDragSource:function(e){return{type:D,id:e}}},at=Object(Me.DropTarget)(Pe,{canDrop:function(e,t){return!0}},function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),isOverCurrent:t.isOver({shallow:!0}),canDrop:t.canDrop(),itemType:t.getItemType()}})(Object(Me.DragSource)(Pe,{beginDrag:function(e){return{id:e.item.id}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(tt)),it=Object(E.b)(function(e){return{smData:e.smData}},nt)(at),rt={li:{border:"2px #999 dashed",opacity:.3},liHovered:{border:"5px #999 dashed",opacity:.5}};var lt=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isOver;return(0,e.connectDropTarget)(r.a.createElement("li",{className:"row-wrapper",style:t?rt.liHovered:rt.li},"Drop here"))}}]),t}(i.Component),st=Object(Me.DropTarget)(Pe,{hover:function(e,t,n){},drop:function(e,t,n){var a=t.getItem();e.handleListItemDrop(a,e.item)}},function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),isOverCurrent:t.isOver({shallow:!0}),canDrop:t.canDrop(),itemType:t.getItemType()}})(lt),ot=Object(E.b)(null,function(e){return{handleListItemDrop:function(t,n){return e({type:I,dragSource:t,dropTarget:n})}}})(st),ct=function(e){return r.a.createElement("ul",{className:"structure-list"},e.items.map(function(e,t){return e?"optional"===e.type?r.a.createElement(ot,{key:t,item:e}):r.a.createElement(it,{key:e.id,item:e}):null}))},ut=new y,mt=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(h.a.mark(function e(){var t,n,a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ut.getRequest("structure.json");case 3:t=e.sent,n=t.data,a=this.addIds([n]),this.props.buildSMUI(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),void 0!==e.t0.response?this.props.handleResponse(e.t0.response.status):void 0!==e.t0.request?this.props.handleResponse(e.t0.request.status):this.props.handleResponse(-1);case 12:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"addIds",value:function(e){var t=Object(ae.a)(e);return function e(t){var n=!0,a=!1,i=void 0;try{for(var r,l=t[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var s=r.value;s.id=oe()(),s.items&&s.items.length>0&&e(s.items)}}catch(o){a=!0,i=o}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}}(t),t}},{key:"render",value:function(){return null}}]),t}(i.Component),dt=Object(E.b)(null,function(e){return{buildSMUI:function(t){return e(Ee(t))},handleResponse:function(t){return e(K(t))}}})(mt),pt=new y,ht=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).handleSaveItClick=function(){var e={json:n.props.smData[0]};pt.postRequest("structure.json",e).then(function(e){n.props.handleResponse(e.status,e.statusText)}).catch(function(e){void 0!==e.response?n.props.handleResponse(e.response.status):n.props.handleResponse(e.request.status)})},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.smData,t=void 0===e?[]:e;return r.a.createElement("section",null,r.a.createElement("h3",null,"HTML Structure Tree from a masterfile in server"),r.a.createElement("br",null),r.a.createElement(dt,null),r.a.createElement(ct,{items:t}),r.a.createElement(H.a,null,r.a.createElement(A.a,{xs:12,className:"text-right"},r.a.createElement(M.a,{bsStyle:"primary",onClick:this.handleSaveItClick},"Save Structure"))))}}]),t}(i.Component),ft=Object(E.b)(function(e){return{smData:e.smData}},a)(ht),vt=n(173),bt=n.n(vt),gt=n(43),Ot=n(36);gt.b.add(Ot.a,Ot.b,Ot.c,Ot.d,Ot.e);var yt=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(Me.DragDropContextProvider,{backend:bt.a},r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"Test Structural Metadata Editor"),r.a.createElement(Z,null),r.a.createElement(Ne,null),r.a.createElement(ft,null)))}}]),t}(i.Component),Et=n(29),Ct={alert:!1},kt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"API_RESPONSE":return Object.assign({},e,{statusCode:t.code,alert:!0});case"CLOSE_ALERT":return Object.assign({},e,{alert:!1});default:return e}},Tt=new ce,jt=[],St=null,Dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return(St=Object(ae.a)(e)).push(t.payload),St;case k:return t.payload;case T:return Tt.deleteListItem(t.id,Object(ae.a)(e));case j:return Tt.determineDropTargets(t.payload,Object(ae.a)(e));case S:return Tt.removeDropTargets(Object(ae.a)(e));case D:return St=Object(ae.a)(e),Tt.findItem(t.id,St).active=!0,St;case w:return Tt.removeActiveDragSources(e);case I:return Tt.handleListItemDrop(t.dragSource,t.dropTarget,e);default:return e}},wt=n(174),It=n.n(wt),xt=new ce,Rt=["#80A590","#2A5459"],Ht=new(function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,[{key:"initPeaks",value:function(e,t){var n=[],a=0;return function e(t){var i=!0,r=!1,l=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var c=s.value;if("span"===c.type){a=a>1?0:a;var u=c.begin,m=c.end,d=c.label,p=c.id;n.push({startTime:xt.toMs(u)/1e3,endTime:xt.toMs(m)/1e3,editable:!1,labelText:d,id:p,color:Rt[a]}),a++}c.items&&c.items.length>0&&e(c.items)}}catch(h){r=!0,l=h}finally{try{i||null==o.return||o.return()}finally{if(r)throw l}}}(e),It.a.init(Object(ne.a)({},t,{segments:n}))}}]),e}()),At={},Ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Ht.initPeaks(t.smData,t.options);default:return e}},Nt=Object(Et.combineReducers)({showForms:kt,smData:Dt,peaksInstance:Ft}),Pt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Mt(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Vt=Object(Et.createStore)(Nt);s.a.render(r.a.createElement(E.a,{store:Vt},r.a.createElement(yt,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/structured-metadata-editor-react",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/structured-metadata-editor-react","/service-worker.js");Pt?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Mt(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Mt(e)})}}()}},[[175,2,1]]]);
//# sourceMappingURL=main.d310e643.chunk.js.map